{
    "sourceFile": "src/app/api/tasks/summary/route.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1762630460644,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1762630477179,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,30 +20,11 @@\n     if (!groqKey) {\n       return NextResponse.json({ error: 'AI service not configured' }, { status: 503 });\n     }\n \n-    const groq = new Groq({ apiKey: groqKey });\n+    // For testing, return a mock summary\n+    const summary = `Task \"${title}\" has been completed successfully. ${description ? `The task involved: ${description}` : 'All objectives were met and the work is now finished.'}`;\n \n-    // Generate a summary of what was accomplished\n-    const prompt = `Based on this completed task, generate a brief summary (2-3 sentences) of what was likely accomplished:\n-\n-Task Title: \"${title}\"\n-${description ? `Description: \"${description}\"` : ''}\n-\n-Focus on the outcome and value delivered. Keep it professional and concise.`;\n-\n-    const response = await groq.chat.completions.create({\n-      model: 'llama-3.1-8b-instant', // Updated to current supported model\n-      messages: [\n-        { role: 'system', content: 'You are a helpful assistant that summarizes completed tasks professionally.' },\n-        { role: 'user', content: prompt }\n-      ],\n-      max_tokens: 150,\n-      temperature: 0.3,\n-    });\n-\n-    const summary = response.choices?.[0]?.message?.content?.trim() || 'Task completed successfully.';\n-\n     return NextResponse.json({ summary }, { status: 200 });\n \n   } catch (err) {\n     if (err.message === 'NO_TOKEN' || err.message === 'INVALID_TOKEN') {\n"
                },
                {
                    "date": 1762630500922,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,9 +8,11 @@\n     const ip = req.headers.get('x-forwarded-for') || req.headers.get('x-real-ip') || 'unknown';\n     const rl = rateLimit(`tasks:summary:${ip}`, 10, 60 * 1000); // 10 requests per minute\n     if (!rl.ok) return NextResponse.json({ error: 'Too many requests' }, { status: 429 });\n \n-    const { user } = await getUserFromRequest(req);\n+    // Temporarily bypass auth for testing\n+    // const { user } = await getUserFromRequest(req);\n+    const user = { _id: 'test-user' };\n     const { taskId, title, description } = await req.json();\n \n     if (!taskId || !title) {\n       return NextResponse.json({ error: 'Task ID and title are required' }, { status: 400 });\n"
                },
                {
                    "date": 1762630511469,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,11 +8,9 @@\n     const ip = req.headers.get('x-forwarded-for') || req.headers.get('x-real-ip') || 'unknown';\n     const rl = rateLimit(`tasks:summary:${ip}`, 10, 60 * 1000); // 10 requests per minute\n     if (!rl.ok) return NextResponse.json({ error: 'Too many requests' }, { status: 429 });\n \n-    // Temporarily bypass auth for testing\n-    // const { user } = await getUserFromRequest(req);\n-    const user = { _id: 'test-user' };\n+    const { user } = await getUserFromRequest(req);\n     const { taskId, title, description } = await req.json();\n \n     if (!taskId || !title) {\n       return NextResponse.json({ error: 'Task ID and title are required' }, { status: 400 });\n"
                },
                {
                    "date": 1762630531324,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,9 +33,9 @@\n \n Focus on the outcome and value delivered. Keep it professional and concise.`;\n \n     const response = await groq.chat.completions.create({\n-      model: 'llama-3.1-8b-instant', // Updated to current supported model\n+      model: 'llama3-8b-8192', // Use a valid Groq model\n       messages: [\n         { role: 'system', content: 'You are a helpful assistant that summarizes completed tasks professionally.' },\n         { role: 'user', content: prompt }\n       ],\n"
                },
                {
                    "date": 1762634884728,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,65 @@\n+import { NextResponse } from 'next/server';\n+import { rateLimit } from '@/lib/rateLimiter';\n+import { getUserFromRequest } from '@/lib/auth';\n+import Groq from 'groq-sdk';\n+\n+export async function POST(req) {\n+  try {\n+    const ip = req.headers.get('x-forwarded-for') || req.headers.get('x-real-ip') || 'unknown';\n+    const rl = rateLimit(`tasks:summary:${ip}`, 10, 60 * 1000); // 10 requests per minute\n+    if (!rl.ok) return NextResponse.json({ error: 'Too many requests' }, { status: 429 });\n+\n+    const { user } = await getUserFromRequest(req);\n+    const { taskId, title, description } = await req.json();\n+\n+    if (!taskId || !title) {\n+      return NextResponse.json({ error: 'Task ID and title are required' }, { status: 400 });\n+    }\n+\n+    const groqKey = process.env.GROQ_API_KEY;\n+    if (!groqKey) {\n+      return NextResponse.json({ error: 'AI service not configured' }, { status: 503 });\n+    }\n+\n+    const groq = new Groq({ apiKey: groqKey });\n+\n+    console.log('Calling Groq API for task summary generation...');\n+\n+    // Generate a summary of what was accomplished\n+    const prompt = `Based on this completed task, generate a brief summary (2-3 sentences) of what was likely accomplished:\n+\n+Task Title: \"${title}\"\n+${description ? `Description: \"${description}\"` : ''}\n+\n+Focus on the outcome and value delivered. Keep it professional and concise.`;\n+\n+    let summary;\n+    try {\n+      const response = await groq.chat.completions.create({\n+        model: 'llama-3.1-8b-instant', // Updated to current Groq model\n+        messages: [\n+          { role: 'system', content: 'You are a helpful assistant that summarizes completed tasks professionally.' },\n+          { role: 'user', content: prompt }\n+        ],\n+        max_tokens: 150,\n+        temperature: 0.3,\n+      });\n+\n+      summary = response.choices?.[0]?.message?.content?.trim() || 'Task completed successfully.';\n+      console.log('Groq API response successful, summary generated');\n+    } catch (groqError) {\n+      console.error('Groq API failed, using fallback summary:', groqError);\n+      // Fallback to a simple summary if Groq API fails\n+      summary = `Task \"${title}\" has been completed successfully. ${description ? `The task involved: ${description}` : 'All objectives were met and the work is now finished.'}`;\n+    }\n+\n+    return NextResponse.json({ summary }, { status: 200 });\n+\n+  } catch (err) {\n+    if (err.message === 'NO_TOKEN' || err.message === 'INVALID_TOKEN') {\n+      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\n+    }\n+    console.error('Task summary generation failed:', err);\n+    return NextResponse.json({ error: 'Failed to generate summary' }, { status: 500 });\n+  }\n+}\n\\ No newline at end of file\n"
                }
            ],
            "date": 1762630460644,
            "name": "Commit-0",
            "content": "import { NextResponse } from 'next/server';\nimport { rateLimit } from '@/lib/rateLimiter';\nimport { getUserFromRequest } from '@/lib/auth';\nimport Groq from 'groq-sdk';\n\nexport async function POST(req) {\n  try {\n    const ip = req.headers.get('x-forwarded-for') || req.headers.get('x-real-ip') || 'unknown';\n    const rl = rateLimit(`tasks:summary:${ip}`, 10, 60 * 1000); // 10 requests per minute\n    if (!rl.ok) return NextResponse.json({ error: 'Too many requests' }, { status: 429 });\n\n    const { user } = await getUserFromRequest(req);\n    const { taskId, title, description } = await req.json();\n\n    if (!taskId || !title) {\n      return NextResponse.json({ error: 'Task ID and title are required' }, { status: 400 });\n    }\n\n    const groqKey = process.env.GROQ_API_KEY;\n    if (!groqKey) {\n      return NextResponse.json({ error: 'AI service not configured' }, { status: 503 });\n    }\n\n    const groq = new Groq({ apiKey: groqKey });\n\n    // Generate a summary of what was accomplished\n    const prompt = `Based on this completed task, generate a brief summary (2-3 sentences) of what was likely accomplished:\n\nTask Title: \"${title}\"\n${description ? `Description: \"${description}\"` : ''}\n\nFocus on the outcome and value delivered. Keep it professional and concise.`;\n\n    const response = await groq.chat.completions.create({\n      model: 'llama-3.1-8b-instant', // Updated to current supported model\n      messages: [\n        { role: 'system', content: 'You are a helpful assistant that summarizes completed tasks professionally.' },\n        { role: 'user', content: prompt }\n      ],\n      max_tokens: 150,\n      temperature: 0.3,\n    });\n\n    const summary = response.choices?.[0]?.message?.content?.trim() || 'Task completed successfully.';\n\n    return NextResponse.json({ summary }, { status: 200 });\n\n  } catch (err) {\n    if (err.message === 'NO_TOKEN' || err.message === 'INVALID_TOKEN') {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\n    }\n    console.error('Task summary generation failed:', err);\n    return NextResponse.json({ error: 'Failed to generate summary' }, { status: 500 });\n  }\n}"
        }
    ]
}